<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="./lib.css" rel="stylesheet">
</head>
<style>
    *{
        margin:0;
        padding:0;
        box-sizing: border-box;
        
        
    }
    body{
      background-color:rgb(218, 193, 193) ;
    }
    
    .backimg{
        margin:0;
        padding:0;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 150vh;
        background: url(./a1.jpeg);
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
      }
      header {
        position: fixed;
        top: 0;
        width: 100%;
        text-align: center;
        padding: 20px ;
        padding-top: 20px;;
        font-size:20px;
        color:black;
        font-family:cursive;
        background-color:rgb(218, 193, 193) ;
    }
    header {
      top: 0;
      width: 100%;
      z-index: 1; 
    }
    
      .box{
        width: 600px;
        height:700px;
        background: transparent;
        color:black;
        border-radius: 35px;
        /* padding: 30px 40px; */
        
      }
      .box h1{
        font-size: 36px;
        text-align: center;
      }
      .box .cont1{
        position: relative;
        width: 100%;
        height: 50px;
        
        margin: 30px 0;
      }
      .cont1 label{
        font-size:20px;
        font-weight: bold;
      }
      .cont1 input{
        width: 100%;
        height: 100%;
        background:rgb(218, 193, 193);
        border: none;
        outline: none;
        border: 2px solid rgb(218, 193, 193);
        border-radius: 40px;
        font-size: 16px;
        color:black;
        padding: 20px 45px 20px 20px;
      }
      .cont1 input::placeholder{
        color:black;
      }
      .box .cont2{
        position: relative;
        width: 100%;
        height: 50px;
      }
      .cont2 label{
        font-size:20px;
        font-weight: bold;
      }
      .cont2 input{
        width: 100%;
        height: 100%;
        background:rgb(218, 193, 193);
        border: none;
        outline: none;
        border: 2px solid rgb(218, 193, 193);
        border-radius: 40px;
        font-size: 16px;
        color:black;
        padding: 20px 45px 20px 20px;
      
      }
    
    
      .cont2 input::placeholder{
        color:black;
      }
    
      .box .cont3{
        position: relative;
        width: 100%;
        height: 50px;
        
        margin: 30px 0;
      }
      .cont3 label{
        font-size:20px;
        font-weight: bold;
      }
      .cont3 input{
        width: 100%;
        height: 100%;
        background:rgb(218, 193, 193);
        border: none;
        outline: none;
        border: 2px solid rgb(218, 193, 193);
        border-radius: 40px;
        font-size: 16px;
        color:black;
        padding: 20px 45px 20px 20px;
      }
      .cont3 input::placeholder{
        color:black;
      }
      .box .cont4{
        position: relative;
        width: 100%;
        height: 50px;
      }
      .cont4 label{
        font-size:20px;
        font-weight: bold;
      }
      .cont4 input{
        width: 100%;
        height:100px;
        background:rgb(218, 193, 193);
        border: none;
        outline: none;
        border: 2px solid rgb(218, 193, 193);
        border-radius: 40px;
        font-size: 16px;
        color:black;
        padding: 20px 45px 20px ;
      }
      .cont4 input::placeholder{
        color:black;
      }
     
     
      .box .button{
        width: 100%;
        height: 45px;
        margin-top:50px;
        background:rgb(218, 193, 193);
        border: none;
        outline: none;
        border-radius: 40px;
        box-shadow: 0 0 10px rgb(218, 193, 193);
        cursor: pointer;
        font-size: 16px;
       font-weight: 600;
      }
       .all{
        display: flex;
        justify-content: center;
      } 

      
.all {
  background-color: #f0f0f0; 
  padding: 20px;
  text-align: center;
  margin-top: 20px;
  border-radius: 10px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.all h1 {
  font-size: 24px;
  color:black;
  font-weight: bold;
}

#newlibrary {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 20px;
}


.library {
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    width: 80%;
    margin-bottom: 15px;
    text-align: center;
}


.button2 {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 10px;
}

.edit-btn, .delete-btn {
    padding: 8px 16px;
    font-size: 14px;
    border-radius: 5px;
    cursor: pointer;
}

.edit-btn {
    background-color: #4CAF50; 
    color: white;
    border: none;
}

.delete-btn {
    background-color: #f44336; 
    color: white;
    border: none;
}

.edit-btn:hover, .delete-btn:hover {
    opacity: 0.9;
}





#newlibrary {
  margin-top: 20px;
  padding: 15px;
  background-color:rgb(218, 193, 193);
  border-radius: 8px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.modal {
  display:none; 
  position: fixed; 
  z-index: 1; 
  left: 0;
  top: 0;
  width: 100%; 
  height: 100%; 
 align-items: center;
  justify-content: center;
  margin-top: 200px; 
}


.modal-content {
  background-color:rgb(218, 193, 193);
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
  max-width: 500px; 
  border-radius: 8px;
  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
}


.close-btn {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
  cursor: pointer;
}

.close-btn:hover,
.close-btn:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}


.modal-content h2 {
  text-align: center;
  color: black;
}

.form-group {
  margin-bottom: 15px;
}

.form-group label {
  display: block;
  font-weight: bold;
  color:black;
  font-family: Arial, Helvetica, sans-serif;
  margin-bottom: 5px;
}

.form-group input,
.form-group textarea {
  width: 100%;
  padding: 8px;
  border-radius: 5px;
  border: 1px solid #ccc;
  box-sizing: border-box;
}


.button .btn {
  width: 100%;
  padding: 10px;
  background-color: #4CAF50;
  color: white;
  font-size: 16px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  margin-top: 10px;
}

.button .btn:hover {
  background-color:rgb(64, 132, 64);
}

    
</style>
<div class="backimg">
  <header>
      <h1>Library Management</h1>
  </header> 

  <div class="box">
      <h1>Library Record's</h1><br>
      <div class="cont1">
          <label for="title">Name</label>
          <input type="text" id="id1" placeholder="Book title" required>
      </div><br>

      <div class="cont2">
          <label for="author">Author</label>
          <input type="text" id="id2" placeholder="Author of book" required>
      </div><br>

      <div class="cont3">
          <label for="date">Date</label>
          <input type="date" id="id3" placeholder="Date of issue" required>
      </div><br>

      <div class="cont4">
          <label for="content">Remarks</label>
          <input type="text" id="id4" required>
      </div><br><br>
      <button type="submit" class="button" onclick="postlibrary()">Submit</button>
  </div>
</div>

<div class="all">
   <h1>ALL INFO</h1>
</div>

<div id="newlibrary"></div>

<div class="modal" id="editModal">
   <div class="modal-content">
       <span class="close-btn" onclick="closeModal()">&times;</span>
       <form id="edit-form" onsubmit="editlibrary(event)">
           <h2>Edit Library</h2>
           <div class="form-group">
               <label for="edit-Name">Name</label>
               <input type="text" class="form-control" id="edit-Name" required>
           </div>
           <div class="form-group">
               <label for="edit-Author">Author</label>
               <input type="text" class="form-control" id="edit-Author" required>
           </div>
           <div class="form-group">
               <label for="edit-Remarks">Remarks</label>
               <textarea class="form-control" id="edit-Remarks" required></textarea>
           </div>
           <div class="button">
               <button class="btn" type="submit">Update</button>
           </div>
       </form>
   </div>
</div>


    </body>
       <script>

       async function postlibrary() {
           const Name =document.getElementById("id1").value;
           const Author=document.getElementById("id2").value;
           const Date=document.getElementById("id3").value;
           const Remarks=document.getElementById("id4").value;
       
       const response=await fetch("http://localhost:4002/api/library",{
        method:'POST',
        headers:{
            'Content-Type': 'application/json'
        },
        body:JSON.stringify({Name,Author,Date,Remarks})
    });
    if(response.ok){
        document.getElementById("id1").value=" ";
        document.getElementById("id2").value=" ";
        document.getElementById("id3").value=" ";
        document.getElementById("id4").value=" ";
        fetchlibrary();
    }else{
        console.error("failed to create a library:",response.statusText)
    }}
    //ivde vare post nte code ahh
async function fetchlibrary(){
  const response=await fetch('http://localhost:4002/api/library');
  const libraries=await response.json();
  const container=document.getElementById("newlibrary");
  container.innerHTML=" ";//to get all the contents inside the html in the div=newlibrary
  
  libraries.forEach(library=>{
    const libraryDiv=document.createElement("div");
    libraryDiv.className="library";
    
    const date = new Date(library.Date);
    const formattedDate = `${String(date.getDate()).padStart(2, '0')}/${String(date.getMonth() + 1).padStart(2, '0')}/${String(date.getFullYear()).slice(-2)}`;
    

   
    libraryDiv.innerHTML=`<h2>Name : ${library.Name}</h2><h2>Author : ${library.Author}</h2><h2>Date : ${formattedDate}</h2><h2><p>Remarks : ${library.Remarks}</p></h2><div class="button2"><button class="edit-btn" onclick="openEditModal('${library._id}', '${library.Name}', '${library.Author}', '${library.Remarks}')">Edit</button>
    <button class="delete-btn" onclick="deleteLibrary('${library._id}')">Delete</button></div>`
    container.appendChild(libraryDiv);


   });
  }
  function openEditModal(id, Name, Author, Remarks) {
    currentEditId = id;
    document.getElementById('edit-Name').value = Name;
    document.getElementById('edit-Author').value = Author;
    document.getElementById('edit-Remarks').value = Remarks;
    document.getElementById('editModal').style.display = 'block';
}

async function editlibrary(e) {
    e.preventDefault();
    const Name = document.getElementById('edit-Name').value;
    const Author = document.getElementById('edit-Author').value;
    const Remarks = document.getElementById('edit-Remarks').value;

    if (currentEditId) {
        const response = await fetch(`http://localhost:4002/api/library/${currentEditId}`, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ Name, Author, Remarks })
        });

        if (response.ok) {
            fetchlibrary();
            closeModal();
        } else {
            console.error('Failed to update library:', response.statusText);
        }
    }
}
async function deleteLibrary(id) {
  const response = await fetch(`http://localhost:4002/api/library/${id}`, {
    method: 'DELETE'
  });

  if (response.ok) {
    fetchlibrary(); 
  } else {
    console.error('Failed to delete library:', response.statusText);
  }
}
function closeModal() {
  document.getElementById("editModal").style.display = "none";
}

  window.onload=fetchlibrary()

  
       </script>

</html>